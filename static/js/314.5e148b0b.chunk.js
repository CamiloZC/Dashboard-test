"use strict";(self.webpackChunkmantis_free_react_admin_template=self.webpackChunkmantis_free_react_admin_template||[]).push([[314],{1936:function(e,t,n){n.d(t,{Z:function(){return F}});var r=n(1413),i=n(5987),o=n(7313),a=n(2111),l=n(7830),u=n(9700),s=n(2669),d=n(3509),c=n(2821),v=n(885),f=n(6157),x=n(1302),h=n(7959),p=n(8104),m=n(8326),g=n(3538),j=n(366),y=n(6217),Z=n(8478),b=n(6417),w=["children"];function _(e){var t=e.children,n=(0,i.Z)(e,w);return(0,b.jsx)(y.Z,(0,r.Z)((0,r.Z)({language:"javacript",showLineNumbers:!0,style:Z.Z},n),{},{children:t}))}var S=n(6407),D=n(1735),k=function(e){var t=e.children,n=(0,o.useState)(!1),r=(0,v.Z)(n,2),i=r[0],a=r[1];return(0,b.jsxs)(f.Z,{sx:{position:"relative"},children:[(0,b.jsx)(x.Z,{sx:{justifyContent:"flex-end",p:1,mb:i?1:0},children:(0,b.jsxs)(f.Z,{sx:{display:"flex",position:"inherit",right:0,top:6},children:[(0,b.jsx)(g.CopyToClipboard,{text:(0,j.ZP)(t,{showFunctions:!0,maxInlineAttributesLineLength:100}),children:(0,b.jsx)(h.Z,{title:"Copy the source",placement:"top-end",children:(0,b.jsx)(p.Z,{color:"secondary",size:"small",sx:{fontSize:"0.875rem"},children:(0,b.jsx)(S.Z,{})})})}),(0,b.jsx)(d.Z,{orientation:"vertical",variant:"middle",flexItem:!0,sx:{mx:1}}),(0,b.jsx)(h.Z,{title:"Show the source",placement:"top-end",children:(0,b.jsx)(p.Z,{sx:{fontSize:"0.875rem"},size:"small",color:i?"primary":"secondary",onClick:function(){return a(!i)},children:(0,b.jsx)(D.Z,{})})})]})}),(0,b.jsx)(m.Z,{in:i,children:i&&(0,b.jsx)(_,{children:(0,j.ZP)(t,{showFunctions:!0,showDefaultProps:!1,maxInlineAttributesLineLength:100})})})]})},I=["border","boxShadow","children","content","contentSX","darkTitle","divider","elevation","secondary","shadow","sx","title","codeHighlight"],A={p:2.5,"& .MuiCardHeader-action":{m:"0px auto",alignSelf:"center"}},F=(0,o.forwardRef)((function(e,t){var n=e.border,o=void 0===n||n,v=e.boxShadow,f=e.children,x=e.content,h=void 0===x||x,p=e.contentSX,m=void 0===p?{}:p,g=e.darkTitle,j=e.divider,y=void 0===j||j,Z=e.elevation,w=e.secondary,_=e.shadow,S=e.sx,D=void 0===S?{}:S,F=e.title,C=e.codeHighlight,O=(0,i.Z)(e,I),P=(0,a.Z)();return v="dark"===P.palette.mode?v||!0:v,(0,b.jsxs)(l.Z,(0,r.Z)((0,r.Z)({elevation:Z||0,ref:t},O),{},{sx:(0,r.Z)((0,r.Z)({},D),{},{border:o?"1px solid":"none",borderRadius:2,borderColor:"dark"===P.palette.mode?P.palette.divider:P.palette.grey.A800,boxShadow:!v||o&&"dark"!==P.palette.mode?"inherit":_||P.customShadows.z1,":hover":{boxShadow:v?_||P.customShadows.z1:"inherit"},"& pre":{m:0,p:"16px !important",fontFamily:P.typography.fontFamily,fontSize:"0.75rem"}}),children:[!g&&F&&(0,b.jsx)(u.Z,{sx:A,titleTypographyProps:{variant:"subtitle1"},title:F,action:w}),g&&F&&(0,b.jsx)(u.Z,{sx:A,title:(0,b.jsx)(s.Z,{variant:"h3",children:F}),action:w}),F&&y&&(0,b.jsx)(d.Z,{}),h&&(0,b.jsx)(c.Z,{sx:m,children:f}),!h&&f,C&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.Z,{sx:{borderStyle:"dashed"}}),(0,b.jsx)(k,{codeHighlight:C,main:!0,children:f})]})]}))}))},464:function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var r=n(1413),i=n(885),o=n(7313),a=n(4500),l=n(8812),u=n(3997),s=n.n(u),d=l.Z.updateData,c=n(2937),v=n(5828),f=n(2669),x=n(3477),h=n(6157),p=n(1936),m=n(54),g=n(737),j=n(6417),y=function(e){var t=e.count,n=e.percentage,r=e.subInfo,i=parseFloat(n)<0;return(0,j.jsxs)(c.ZP,{container:!0,alignItems:"left",direction:"column",xs:4,children:[(0,j.jsxs)(c.ZP,{container:!0,direction:"row",flexWrap:"nowrap",children:[(0,j.jsx)(c.ZP,{item:!0,children:(0,j.jsx)(f.Z,{variant:"h4",color:"inherit",children:t})}),n&&(0,j.jsx)(c.ZP,{children:(0,j.jsxs)(f.Z,{color:i?"red":"green",children:[!i&&(0,j.jsx)(m.Z,{style:{fontSize:"0.75rem",color:"green"}}),i&&(0,j.jsx)(g.Z,{style:{fontSize:"0.75rem",color:"red"}}),n]})})]}),(0,j.jsx)(h.Z,{children:(0,j.jsx)(f.Z,{variant:"caption",color:"textSecondary",children:(0,j.jsx)(f.Z,{component:"span",variant:"caption",children:r})})})]})},Z=function(e){var t=e.title,n=e.isGeneral,r=e.isAverage,i=e.data,o=e.prevData,a=e.numDays,l=null===i||void 0===i?void 0:i.reduce((function(e,t){return e+t.order_revenue}),0),u=null===i||void 0===i?void 0:i.reduce((function(e,t){return e+t.num_orders}),0),s=null===i||void 0===i?void 0:i.reduce((function(e,t){return e+t.item_quantity}),0),d=null===i||void 0===i?void 0:i.filter((function(e){return"New"===e.customer_type})),c=null===d||void 0===d?void 0:d.reduce((function(e,t){return e+t.num_orders}),0),x=(null===d||void 0===d?void 0:d.reduce((function(e,t){return e+t.order_revenue}),0))/l*100,h=l/a,m=u/a,g=s/u,Z=l/u,b=c/a,w=null===o||void 0===o?void 0:o.reduce((function(e,t){return e+t.order_revenue}),0),_=null===o||void 0===o?void 0:o.reduce((function(e,t){return e+t.num_orders}),0),S=null===o||void 0===o?void 0:o.reduce((function(e,t){return e+t.item_quantity}),0),D=null===o||void 0===o?void 0:o.filter((function(e){return"New"===e.customer_type})),k=null===D||void 0===D?void 0:D.reduce((function(e,t){return e+t.num_orders}),0),I=(null===D||void 0===D?void 0:D.reduce((function(e,t){return e+t.order_revenue}),0))/w*100,A=w/30,F=_/30,C=S/_,O=w/_,P=k/30,M=(l-w)/w*100,N=(u-_)/_*100,R=(c-k)/k*100,E=(x-I)/I*100,T=(h-A)/A*100,z=(m-F)/F*100,L=(g-C)/C*100,q=(Z-O)/O*100,W=(b-P)/P*100,Y=function(e){return e>9999&&e<999999?(e/1e3).toFixed(2).toString()+"k":e>999999?(e/1e6).toFixed(2).toString()+"M":e.toFixed(2).toString()},H=function(e){return e.toFixed(2).toString()+"%"},G=[{count:l?Y(l):0,percentage:M?H(M):0,subInfo:"Total revenue"},{count:u?Y(u):0,percentage:N?H(N):0,subInfo:"Total orders"},{count:c?Y(c):0,percentage:R?H(R):0,subInfo:"New customers"},{count:x?H(x):0,percentage:E?H(E):0,subInfo:"% New Customers Revenue"}],J=[{count:h?Y(h):0,percentage:T?H(T):0,subInfo:"Av Revenue/Day"},{count:m?Math.trunc(Y(m)):0,percentage:z?H(z):0,subInfo:"Avg Orders/Day"},{count:g?Y(g):0,percentage:L?H(L):0,subInfo:"Avg Items/Order"},{count:Z?Y(Z):0,percentage:q?H(q):0,subInfo:"Avg Order Value"},{count:b?Math.trunc(Y(b)):0,percentage:W?H(W):0,subInfo:"Avg New Customers/Day"}];return(0,j.jsxs)(p.Z,{contentSX:{p:2.25},children:[(0,j.jsx)(f.Z,{variant:"h4",mb:1.5,children:t}),n?(0,j.jsx)(v.Z,{spacing:.5,direction:"row",children:G.map((function(e){return(0,j.jsx)(y,{count:e.count,percentage:e.percentage,subInfo:e.subInfo})}))}):null,r?(0,j.jsx)(v.Z,{spacing:.5,direction:"row",children:J.map((function(e){return(0,j.jsx)(y,{count:e.count,percentage:e.percentage,subInfo:e.subInfo})}))}):null]})},b=n(5845),w=n.n(b),_=n(7548),S=n.n(_),D=function(e){var t=e.data,n=(0,o.useState)({}),r=(0,i.Z)(n,2),a=r[0],l=r[1],u=null===t||void 0===t?void 0:t.reduce((function(e,t){return e[t.order_revenue_source]||(e[t.order_revenue_source]=0),e[t.order_revenue_source]+=t.order_revenue,e}),{}),s=u?Object.keys(u).map((function(e){return{source:e,revenue:u[e]}})):null,d=null===s||void 0===s?void 0:s.sort((function(e,t){return t.revenue-e.revenue})),c=null===d||void 0===d?void 0:d.map((function(e){return e.source})),v=null===d||void 0===d?void 0:d.map((function(e){return e.revenue}));return(0,o.useEffect)((function(){l({title:{text:"Revenue by Source",align:"left"},chart:{type:"bar",zoomType:"y"},xAxis:{categories:c||null},yAxis:{title:{text:"Revenue"},tickInterval:2e5,labels:{formatter:function(){return this.value>999&&this.value<999999?this.value/1e3+"k":this.value>999999?this.value/1e6+"M":this.value}}},series:[{name:"Revenue",data:v||null}]})}),[t]),(0,j.jsx)("div",{children:t?(0,j.jsx)(S(),{highcharts:w(),options:a}):(0,j.jsx)("p",{children:"Loading chart..."})})},k=function(e){var t=e.data,n=e.type,r=e.view,a=(0,o.useState)({}),l=(0,i.Z)(a,2),u=l[0],s=l[1],d=null===t||void 0===t?void 0:t.reduce((function(e,t){var n,i=t.order_date,o=t.customer_type,a=t.order_revenue,l=t.num_orders,u="daily"===r?i:"monthly"===r?"1/"===(n=t.order_date.substring(0,2))||"1"===n?"Jan":"2/"===n||"2"===n?"Feb":"3/"===n||"3"===n?"Mar":"4/"===n||"4"===n?"Apr":"5/"===n||"5"===n?"May":"6/"===n||"6"===n?"Jun":"7/"===n||"7"===n?"Jul":"8/"===n||"8"===n?"Aug":"9/"===n||"9"===n?"Sep":"10/"===n||"10"===n?"Oct":"11/"===n||"11"===n?"Nov":"12/"===n||"12"===n?"Dec":void 0:null;return e[u]||(e[u]={}),e[u][o]||(e[u][o]={revenue:0,orders:0}),e[u][o].revenue+=a,e[u][o].orders+=l,e}),{}),c=["Existing","New"],v=d?Object.entries(d).map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return{order_date:n,data:c.map((function(e){return r[e]||0}))}})):null;return(0,o.useEffect)((function(){s({title:{text:"Revenue by Date",align:"left"},chart:{type:"column"},xAxis:{categories:null===v||void 0===v?void 0:v.map((function(e){return e.order_date}))},yAxis:[{labels:{formatter:function(){return this.value>999?this.value/1e3+"k":this.value}},title:{text:"Existing Customer Revenue"},min:0,tickInterval:2e4},{labels:{formatter:function(){return this.value>999?this.value/1e3+"k":this.value}},title:{text:"Total Orders"},min:0,tickInterval:650,opposite:!0}],plotOptions:{column:{stacking:"normal",dataLabels:{enabled:!0,formatter:function(){return"$"+Math.floor(this.point.stackTotal)},style:{fontWeight:"bold",textOutline:!1},y:-30,verticalAlign:"top"},stackLabels:{enabled:!0,style:{fontWeight:"bold",color:"gray"},formatter:function(){return this.point.stackTotal}}}},series:[{type:"column",name:"New Customer Revenue",data:"All"===n||"New"===n?null===v||void 0===v?void 0:v.map((function(e){return parseFloat(e.data[1].revenue.toFixed(3))})):[]},{type:"column",name:"Existing Customer Revenue",data:"New"===n?[]:null===v||void 0===v?void 0:v.map((function(e){return parseFloat(e.data[0].revenue.toFixed(3))})),dataLabels:{enabled:"Existing"===n,style:{fontWeight:"bold",color:"black"}}},{type:"spline",yAxis:1,name:"Total Orders",data:"All"===n?null===v||void 0===v?void 0:v.map((function(e){var t,n;return parseInt(null===(t=e.data[0])||void 0===t?void 0:t.orders)+parseInt(null===(n=e.data[1])||void 0===n?void 0:n.orders)})):"New"===n?null===v||void 0===v?void 0:v.map((function(e){var t;return parseInt(null===(t=e.data[1])||void 0===t?void 0:t.orders)})):"Existing"===n?null===v||void 0===v?void 0:v.map((function(e){var t;return parseInt(null===(t=e.data[0])||void 0===t?void 0:t.orders)})):null,marker:{lineWidth:2,lineColor:w().getOptions().colors[1],fillColor:"white"}},{type:"spline",yAxis:1,name:"New Customer Orders",data:"All"===n||"New"===n?null===v||void 0===v?void 0:v.map((function(e){return parseFloat(e.data[1].orders.toFixed(3))})):[],marker:{lineWidth:2,lineColor:w().getOptions().colors[3],fillColor:"orange"}}]})}),[t]),(0,j.jsx)("div",{children:t?(0,j.jsx)(S(),{highcharts:w(),options:u}):(0,j.jsx)("p",{children:"Loading chart..."})})},I=function(e){return e.sort((function(e,t){return new Date(e.order_date)-new Date(t.order_date)})),e},A=function(e){var t=e.data,n=(0,o.useState)(null),r=(0,i.Z)(n,2),a=r[0],l=r[1];return(0,o.useEffect)((function(){var e=null===t||void 0===t?void 0:t.reduce((function(e,t){var n=function(e){var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+t.getDay()+1)/7)}(new Date(t.order_date)),r=t.order_revenue_source,i=t.order_revenue;return e[n]||(e[n]={}),e[n][r]||(e[n][r]=0),e[n][r]+=i,e}),{}),n=Object.keys(e).map((function(t){var n=e[t],r=Object.values(n).reduce((function(e,t){return e+t}),0);return{week:parseInt(t),sources:n,totalRevenue:r}})).sort((function(e,t){return t.totalRevenue-e.totalRevenue})),r={chart:{type:"column"},title:{text:"Revenue by Source",align:"left"},xAxis:{categories:Object.keys(e).map((function(e){return parseInt(e)}))},yAxis:{labels:{format:"{value} %"},min:0,tickInterval:20,title:{text:null}},legend:{reversed:!0},plotOptions:{column:{stacking:"percent"}},series:Object.keys(n[0]?n[0].sources:{}).map((function(e){return{name:e,data:n.map((function(t){return t.sources[e]||0}))}}))};l(r)}),[t]),(0,j.jsx)("div",{children:a?(0,j.jsx)(S(),{highcharts:w(),options:a}):"Loading..."})},F=n(1378),C=n.n(F),O=(n(2632),function(){var e=(0,o.useState)("daily"),t=(0,i.Z)(e,2),l=t[0],u=t[1];!function(){var e=(0,a.I0)();(0,o.useMemo)((function(){var t=n(3685);s().parse(t,{header:!0,download:!0,skipEmptyLines:!0,complete:function(t){var n=t.data;e(d(n))}})}),[e])}();var m=(0,a.v9)((function(e){return e.Data.data})),g=(0,o.useState)(null),y=(0,i.Z)(g,2),b=y[0],w=y[1],_=(0,o.useState)(null),S=(0,i.Z)(_,2),F=S[0],O=S[1],P=(0,o.useState)(30),M=(0,i.Z)(P,2),N=M[0],R=M[1],E=(0,o.useState)([]),T=(0,i.Z)(E,2),z=T[0],L=T[1],q=(0,o.useState)([]),W=(0,i.Z)(q,2),Y=W[0],H=W[1],G=(0,o.useState)("All"),J=(0,i.Z)(G,2),X=J[0],V=J[1],$=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()-t);return I(e.filter((function(e){return new Date(e.order_date)>=r})))}(m),B=function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()-30),r=new Date(n.getFullYear(),n.getMonth(),n.getDate()-30);return I(e.filter((function(e){return new Date(e.order_date)>=r})).filter((function(e){return new Date(e.order_date)<n})))}(m),K=function(e,t){"start"===t?w(e):"end"===t&&O(e)};(0,o.useEffect)((function(){if(b&&F){var e=m.filter((function(e){var t=new Date(e.order_date);return t>=b&&t<=F}));L(I(e)),R(Math.floor((F-b)/864e5)+1)}else L(I($))}),[m,b,F]),(0,o.useEffect)((function(){if(b&&F){var e=b,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()-30),n=m.filter((function(n){var r=new Date(n.order_date);return r>t&&r<e}));H(I(n))}else H(I(B))}),[m,b,F]);var Q=null===z||void 0===z?void 0:z.map((function(e){return(0,r.Z)((0,r.Z)({},e),{},{order_revenue:parseFloat(parseFloat(e.order_revenue).toFixed(3)),num_orders:parseInt(e.num_orders),item_quantity:parseInt(e.item_quantity)})})),U=null===Y||void 0===Y?void 0:Y.map((function(e){return(0,r.Z)((0,r.Z)({},e),{},{order_revenue:parseFloat(parseFloat(e.order_revenue).toFixed(3)),num_orders:parseInt(e.num_orders),item_quantity:parseInt(e.item_quantity)})})),ee=null===Q||void 0===Q?void 0:Q.filter((function(e){return"All"===X||e.customer_type===X})),te=null===U||void 0===U?void 0:U.filter((function(e){return"All"===X||e.customer_type===X}));return(0,j.jsxs)(c.ZP,{container:!0,rowSpacing:4.5,columnSpacing:2.75,p:5,children:[(0,j.jsx)(c.ZP,{item:!0,xs:24,md:12,lg:12,children:(0,j.jsx)(p.Z,{content:!1,sx:{mt:1.5},children:(0,j.jsxs)(v.Z,{spacing:.5,direction:"row",ml:5,gap:5,height:50,alignItems:"center",children:[(0,j.jsx)(f.Z,{variant:"h5",children:"Filters"}),(0,j.jsx)(f.Z,{variant:"h8",mr:0,children:"Customer type:"}),(0,j.jsxs)("select",{value:X,onChange:function(e){return V(e.target.value)},children:[(0,j.jsx)("option",{value:"All",children:"All"}),(0,j.jsx)("option",{value:"New",children:"New"}),(0,j.jsx)("option",{value:"Existing",children:"Existing"})]}),(0,j.jsx)(f.Z,{variant:"h8",mr:0,children:"Data range:"}),(0,j.jsx)(C(),{selected:b,selectsStart:!0,onChange:function(e){return K(e,"start")},placeholderText:"Start Date"}),(0,j.jsx)(C(),{selected:F,onChange:function(e){return K(e,"end")},placeholderText:"End Date"}),(0,j.jsx)(f.Z,{variant:"h8",pl:20,children:"View options:"}),(0,j.jsx)(x.Z,{size:"small",onClick:function(){return u("monthly")},color:"monthly"===l?"primary":"secondary",variant:"monthly"===l?"outlined":"text",children:"Monthly"}),(0,j.jsx)(x.Z,{size:"small",onClick:function(){return u("daily")},color:"daily"===l?"primary":"secondary",variant:"daily"===l?"outlined":"text",children:"Daily"})]})})}),(0,j.jsx)(c.ZP,{item:!0,xs:12,sx:{mb:-2.25},children:(0,j.jsx)(f.Z,{variant:"h5",children:"Revenue Overview"})}),(0,j.jsx)(c.ZP,{item:!0,xs:12,sm:12,md:8,lg:6,children:(0,j.jsx)(Z,{title:"General Metrics",isGeneral:!0,data:ee||$,prevData:te,numDays:N})}),(0,j.jsx)(c.ZP,{item:!0,xs:12,sm:12,md:8,lg:6,children:(0,j.jsx)(Z,{title:"Average Performance",isAverage:!0,data:ee||$,prevData:te,numDays:N})}),(0,j.jsx)(c.ZP,{item:!0,md:8,sx:{display:{sm:"none",md:"block",lg:"none"}}}),(0,j.jsx)(c.ZP,{item:!0,xs:24,md:12,lg:12,children:(0,j.jsx)(p.Z,{content:!1,sx:{mt:1.5},children:(0,j.jsx)(h.Z,{sx:{pt:1,pr:2},children:(0,j.jsx)(k,{data:ee||$,type:X,view:l})})})}),(0,j.jsx)(c.ZP,{item:!0,xs:12,md:6,lg:6,children:(0,j.jsx)(p.Z,{sx:{mt:1.75},children:(0,j.jsx)(A,{data:ee||$})})}),(0,j.jsx)(c.ZP,{item:!0,xs:12,md:6,lg:6,children:(0,j.jsx)(p.Z,{sx:{mt:1.75},children:(0,j.jsx)(D,{data:ee||$,view:l})})})]})})},3685:function(e,t,n){e.exports=n.p+"static/media/revenue-by-date-full.98f0c4ee5f9c18402a93.csv"}}]);